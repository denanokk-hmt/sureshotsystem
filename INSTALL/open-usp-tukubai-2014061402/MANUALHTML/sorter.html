<!doctype html>

<html lang="ja">
<head>
  <meta charset="utf-8">
  <title>UEC - usp engineers' community - Tukubaiオンラインコマンドマニュアル</title>
  <link rel="stylesheet" href="COMMON/CSS/MAIN.CSS" />
  <link rel="stylesheet" href="COMMON/CSS/MENU.CSS" />
  <link rel="stylesheet" href="COMMON/CSS/PRINT.CSS" />
  <!--[if lte IE 8]>
  <link rel="stylesheet" href="COMMON/CSS/IE67HACK.CSS" />
  <![endif]-->
  <!--[if IE 7]>
  <link rel="stylesheet" href="COMMON/CSS/IE7HACK.CSS" />
  <![endif]-->
  <!--[if IE 6]>
  <link rel="stylesheet" href="COMMON/CSS/IE6HACK.CSS" />
  <![endif]-->
  <script src="COMMON/JS/MENU.JS"></script>
</head>
<body>
  <div id="container">
    <div id="header">
      <div id="logo">
        <img id="logoimage" src="COMMON/IMG/TUKUBAI_LOGO.JPG" />
      </div>
      <div id="title">
        <p id="slogan"></p>
        <ul id="megamenu">
          <li id="tukubai_man"><a href="index.html" class="target">Tukubaiマニュアル</a>
            <ul>
              <li><a href="calclock.html">calclock(1)</a></li>
              <li><a href="cgi-name.html">cgi-name(1)</a></li>
              <li><a href="check_attr_name.html">check_attr_name(1)</a></li>
              <li><a href="check_need_name.html">check_need_name(1)</a></li>
              <li><a href="cjoin0.html">cjoin0(1)</a></li>
              <li><a href="cjoin1.html">cjoin1(1)</a></li>
              <li><a href="cjoin2.html">cjoin2(1)</a></li>
              <li><a href="comma.html">comma(1)</a></li>
              <li><a href="count.html">count(1)</a></li>
              <li><a href="ctail.html">ctail(1)</a></li>
              <li><a href="dayslash.html">dayslash(1)</a></li>
              <li><a href="delf.html">delf(1)</a></li>
              <li><a href="divsen.html">divsen(1)</a></li>
              <li><a href="filehame.html">filehame(1)</a></li>
              <li><a href="formhame.html">formhame(1)</a></li>
              <li><a href="getfirst.html">getfirst(1)</a></li>
              <li><a href="getlast.html">getlast(1)</a></li>
              <li><a href="gyo.html">gyo(1)</a></li>
              <li><a href="han.html">han(1)</a></li>
              <li><a href="join0.html">join0(1)</a></li>
              <li><a href="join1.html">join1(1)</a></li>
              <li><a href="join2.html">join2(1)</a></li>
              <li><a href="juni.html">juni(1)</a></li>
              <li><a href="kasan.html">kasan(1)</a></li>
              <li><a href="keta.html">keta(1)</a></li>
              <li><a href="keycut.html">keycut(1)</a></li>
              <li><a href="loopj.html">loopj(1)</a></li>
              <li><a href="loopx.html">loopx(1)</a></li>
              <li><a href="map.html">map(1)</a></li>
              <li><a href="marume.html">marume(1)</a></li>
              <li><a href="mdate.html">mdate(1)</a></li>
              <li><a href="mime-read.html">mime-read(1)</a></li>
              <li><a href="mojihame.html">mojihame(1)</a></li>
              <li><a href="nameread.html">nameread(1)</a></li>
              <li><a href="plus.html">plus(1)</a></li>
              <li><a href="rank.html">rank(1)</a></li>
              <li><a href="ratio.html">ratio(1)</a></li>
              <li><a href="retu.html">retu(1)</a></li>
              <li><a href="self.html">self(1)</a></li>
              <li><a href="sm2.html">sm2(1)</a></li>
              <li><a href="sm4.html">sm4(1)</a></li>
              <li><a href="sm5.html">sm5(1)</a></li>
              <li><a href="tarr.html">tarr(1)</a></li>
              <li><a href="tateyoko.html">tateyoko(1)</a></li>
              <li><a href="tcat.html">tcat(1)</a></li>
              <li><a href="unmap.html">unmap(1)</a></li>
              <li><a href="up3.html">up3(1)</a></li>
              <li><a href="yarr.html">yarr(1)</a></li>
              <li><a href="ycat.html">ycat(1)</a></li>
              <li><a href="yobi.html">yobi(1)</a></li>
              <li><a href="ysum.html">ysum(1)</a></li>
              <li><a href="zen.html">zen(1)</a></li>
              <li class="separator"><hr/></li>
              <li class="separator"><hr/></li>
              <li class="separator"><hr/></li>
              <li><a href="tag-format.html">タグ形式(5)</a></li>
              <li><a href="name-format.html">ネーム形式(5)</a></li>
              <li><a href="field-format.html">フィールド形式(5)</a></li>
              <li><a href="master-file.html">マスタファイル(5)</a></li>
              <li><a href="name-file.html">ネームファイル(5)</a></li>
              <li><a href="transaction-file.html" class="target">トランザクションファイル(5)</a></li>
            </ul> 
          </li>
        </ul>
      </div>
    </div>

    <div id="main">
      <h1>Tukubaiオンラインコマンドマニュアル</h1>

      <h2>sorter(1)</h2>

      <h3>【名前】</h3>

      <p>sorter : キーでファイル分割する(キーについて整列不要)</p>

      <h3>【書式】</h3>

      <pre class="list">Usage   : sorter.NEW [options] &lt;filename&gt; &lt;file&gt;
Options : -d : delete key
          -a : append file
          -z : compress
Version : Mon Nov 18 12:16:37 JST 2013</pre>

      <h3>【説明】</h3>

      <p>&lt;file&gt;を読み込み、分割先ファイル名&lt;filename&gt;で指定したキーフィールドの値が同一のレコードでファイルを分割する。たとえば、第2フィールドが同じ値を持つレコードでファイルを分割したいときはdata.%2のように&lt;filename&gt;を指定する。この時、分割先ファイル名は、data.(第2フィールドの値)となる。</p>

      <p>sorterは<a href="keycut.html">keycut</a>と異なりキーフィールドの値は整列されている必要はない。また、レコードは発生順にファイルに分割されていくので分割結果も整列されない。</p>

      <p>&lt;filename&gt;におけるキーフィールドは%(フィールド番号)と指定するが%5.2や%5.1.3のようにサブストリング指定も可能だ。%指定において%1.5を%{1.5}のように{}で範囲を明確にして記述することができる。</p>

      <h3>【例1】</h3>

      <pre class="prettyprint">$ at data
04 神奈川県 13 横浜市 92 56 83 96 75
01 埼玉県 03 熊谷市 82 0 23 84 10
03 千葉県 10 千葉市 52 91 44 9 0
02 東京都 04 新宿区 30 50 71 36 30
01 埼玉県 01 さいたま市 91 59 20 76 54
03 千葉県 12 柏市 95 60 35 93 76
04 神奈川県 16 小田原市 45 21 24 39 03
02 東京都 05 中央区 78 13 44 28 51
$ sorter data.%1 data
$ ls -l data.*
-rw-r--r-- 1 usp usp 87 2月 19 11:14 data.01       ↑
-rw-r--r-- 1 usp usp 82 2月 19 11:14 data.02 ４つのファイルに
-rw-r--r-- 1 usp usp 77 2月 19 11:14 data.03 分割された
-rw-r--r-- 1 usp usp 91 2月 19 11:14 data.04       ↓
$ cat data.01
01 埼玉県 03 熊谷市 82 0 23 84 10
01 埼玉県 01 さいたま市 91 59 20 76 54
$ cat data.02
02 東京都 04 新宿区 30 50 71 36 30
02 東京都 05 中央区 78 13 44 28 51
$ cat data.03
03 千葉県 10 千葉市 52 91 44 9 0
03 千葉県 12 柏市 95 60 35 93 76
$ cat data.04
04 神奈川県 13 横浜市 92 56 83 96 75
04 神奈川県 16 小田原市 45 21 24 39 03
$</pre>

      <h3>【例2】</h3>

      <pre class="prettyprint">$ sorter data.%1.2.1 data
$ ls -l data.*
-rw-r--r-- 1 usp usp 87 2月 19 11:15 data.1
-rw-r--r-- 1 usp usp 82 2月 19 11:15 data.2
-rw-r--r-- 1 usp usp 77 2月 19 11:15 data.3
-rw-r--r-- 1 usp usp 91 2月 19 11:15 data.4
$</pre>

      <h3>【例3】</h3>

      <p>-aオプションを指定すると分割先ファイルは追記されている。分割先ファイルが無いときは新たに作成されている。このオプションを指定しないときはファイルは上書きされている。</p>

      <pre class="prettyprint">$ sorter data.%1 data
$ sorter -a data.%1 data
$ ls -l data.*
-rw-r--r-- 1 usp usp 174 2月 19 11:16 data.01
-rw-r--r-- 1 usp usp 164 2月 19 11:16 data.02
-rw-r--r-- 1 usp usp 154 2月 19 11:16 data.03
-rw-r--r-- 1 usp usp 182 2月 19 11:16 data.04
$</pre>

      <h3>【例4】</h3>

      <p>-dオプションを指定するとキーフィールドを除いたレコードを分割先ファイルに作成する。キーフィールド指定が%1.2.1等のサブストリグン指定であっても、キーフィールド全体(この例だと第1フィールド全体)が取り除かれる。</p>

      <pre class="prettyprint">$ $ sorter -d data.%1 data
$ ls -l data.*
-rw-r--r-- 1 usp usp 81 2月 19 13:13 data.01
-rw-r--r-- 1 usp usp 76 2月 19 13:13 data.02
-rw-r--r-- 1 usp usp 71 2月 19 13:13 data.03
-rw-r--r-- 1 usp usp 85 2月 19 13:13 data.04
$ cat data.01
埼玉県 03 熊谷市 82 0 23 84 10
埼玉県 01 さいたま市 91 59 20 76 54
$</pre>

      <h3>【例5】</h3>

      <p>-zオプションを指定すると出力ファイルがgzip圧縮形式になる。</p>

      <pre class="prettyprint">$ sorter -z data.%1.gz data
$ ls -l data.*
-rw-r--r-- 1 usp usp  98 2月 19 13:17 data.01.gz
-rw-r--r-- 1 usp usp  94 2月 19 13:17 data.02.gz
-rw-r--r-- 1 usp usp  82 2月 19 13:17 data.03.gz
-rw-r--r-- 1 usp usp 100 2月 19 13:17 data.04.gz
$ gunzip < data.01.gz
01 埼玉県 03 熊谷市 82 0 23 84 10
01 埼玉県 01 さいたま市 91 59 20 76 54
$</pre>

      <h3>【備考】</h3>

      <p>sorter(1)は基本的には入力ファイルをすべて読み込んでから処理する。ただし、メモリが不足したときおよび物理メモリの半分以上を使用した場合は、一旦ファイルへ出力してから処理を続行する。</p>

      <p>-aオプションと-zを併用したときはすでに存在する圧縮ファイルに圧縮ファイルが追記されている。出力ファイルはgunzipで正しく解凍される。</p> 

      <p>sorter.cはzlibを使用している。コンパイル時はcc -static -O3 -o sorter sorter.c -lzのようにオプションを指定する。</p>

      <h3>【関連項目】</h3>

      <p><a href="keycut.html">keycut(1)</a>、<a href="field-format.html">フィールド形式(5)</a></p>
    </div>

    <div id="lastmodified">last modified: 2014-39-27 17:02:27</div>

    <div id="footer">Contact us: uecinfo@usp-lab.com<br/>Copyright (c) 2012,2013 <a href="http://www.usp-lab.com/">Universal Shell Programming Laboratory</a> All Rights Reserved.</div>
  </div>
</body>
</html>
