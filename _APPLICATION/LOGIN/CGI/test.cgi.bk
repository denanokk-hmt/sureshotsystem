#!/bin/bash -vx
#

##################################################
#       test.cgi
#
#       written by hmt 2016.2.20

##################################################
# 基本設定
LANG=ja_JP.UTF-8
PATH=/home/:/usr/local/bin:$PATH
apld=/home/sureshotsystem/APPLICATION/LOGIN
#exec 2> /dev/null
exec 2> $apld/LOG/LOG.$(basename $0).$(date +%Y%m%d)
tmp=/tmp/tmp_$$

##################################################
# エラーチェック
ERROR_CHECK(){
	[ $(plus ${PIPESTATUS[@]}) -eq 0 ]  && return
cat <<- FIN
	Content-type: text/html
	NG Input
FIN
	cat $tmp-result
	exit 1
}

##################################################
# 変数の取得
if [ ! -z $CONTENT_LENGTH ]; then
	dd bs=$CONTENT_LENGTH	|
	cgi-name -n_ -s_		> $tmp-name
else
        touch $tmp-name
fi

##################################################
# 変数のチェック
cat << FIN > $tmp-check
NAME x20
FIN

check_attr_name $tmp-check $tmp-name > $tmp-result


echo "Content-type: text/html"
echo ""

cat $apld/LOGIN/HTML/test.html

cat $tmp-name   |
sed -e 's/$/<br>/g'

rm -f $tmp-*
exit 0

