<!--<!DOCTYPE html>-->
<!--<html>-->
<div class="container">
    
    <div class="fixed gray-trans-over z-index-3" style="padding:10px;">

        <!--Header Info-->
        <div class="row">
            <div class="col-sm-6 lbl-header-info">
                <span id="info-msg" class="label label-lg ">
                    ###INFO_MSG###
                </span>
                <span id="appraisal-info" class="label label-lg label-success">
                    ###APPRAISAL_INFO###
                </span>
                <span id="customer-info" class="label label-lg ">
                    ###CUSTOMER_INFO###
                </span>
            </div>
        </div>
        <br>
        <!--Goto Another Function-->
        <div class="btn-toolbar">
            <button class="btn btn-default col-smx-3" />Customer</button>
            <button class="btn btn-default col-smx-3" />Operation</button>
            <button class="btn btn-default col-smx-3" />Parts</button>
            <button class="btn btn-default col-smx-3" />Set</button>
            <button class="btn btn-info col-smx-3 disabled" />Confirm</button>
        </div>

    </div>
</div>

<!--Spacer-->
<div class="header-dummy" style="height:9.0em; background-color:piiink;"></div>

<!--Contents Records-->
<div class="container">
    <div class="row">
        <div class="contents-table">
            ###TABLE###
        </div>
    </div>
</div>

<div class="container">
    <div class="row">
        <!--Contents-->
        <div class="col-md-4">
            <div class="contents">
                <form name="appraisal" action="" method="">
            		    <input type="hidden" id="TEMP_NO" name="TEMP_NO" value="###TEMP_NO###" />
                </form>
           </div>
        </div>
    </div>

    <div class="row">
        <!--Contents-->
        <div class="col-md-4">
            <div class="contents">
               <button type="submit" id="Complete" class="btn btn-danger btn-lg" />
                    Complete
                </button>
            </div>
        </div>
    </div>

    <!--強制リダイレクト指示-->
    <input type="hidden" id="redirect-force" name="redirect-force" value="###REDIRECT_FORCE###" />
</div>

<script>

    //エラーによる強制リダイレクト指示
    $(document).ready(function(){
        redirect = $('#redirect-force').val();
        if (redirect) {
          location.href = redirect;
        }
    });
 
    //HEADページ移動
    $(".btn-toolbar .btn").on('click', function() {
        var temp_no = $("#TEMP_NO").val();
        var func = $(this).html().toUpperCase();
        var frm = document.forms['appraisal'];
        frm.method = 'GET';
        frm.action = '/APP/APPRAISAL/EDIT/' + func + '/INPUT';
        frm.submit();
    });

    //COMPLETEボタン
    $('#Complete').on('click', function() {


        //基本情報
        var temp_no = $('#TEMP_NO').val();
        
        //バリデーション
        var operation_lbl = $('#operation-label').text(); 
        var parts_lbl = $('#parts-label').text(); 
        if (operation_lbl == '見積なし' && parts_lbl == '見積なし') {
            alert("見積が未登録です。");
            return;
        }

        //仮登録の登録・更新・削除
        var jqXHR = $.ajax({
            type: 'POST',
            url: '/APP/APPRAISAL/EDIT/COMPLETE',
            data: {
              TEMP_NO: temp_no
            }
        });
        jqXHR.done(function(data) {
            if (data == 2222) {
                alert("査定番号:" + temp_no + "の見積登録に失敗しました。");
            } else {
                alert(temp_no + "の見積登録が完了しました。");
                location.href = '/APP/APPRAISAL/LISTS/SHOW';
            }
        });
        jqXHR.fail(function(data) {
            alert("見積登録に失敗しました。");
        });
    });

</script>
<!--</html>-->
