<!--<!DOCTYPE html>-->
<!--<html>-->

<div class="container">
    
    <div class="fixed">

        <!--Header Info-->
        <div class="row">
            <label class="control-label col-sm-1">
                <h3><i class="glyphicon glyphicon-info-sign"></i></h3>
            </label>
            <div class="col-sm-6 lbl-header-info">
                <span id="info-msg" class="label label-lg label-###INFO_LV###">
                    ###INFO_MSG###
                </span>
            </div>
        </div>

        <!--Search-->
        <!--

        -->
    </div>

    <!--Spacer-->
    <div class="header-dummy" style="height:7.0em; background-color:piiiiink;"></div>

    <!--Contents-->
    <div class="header-under-contents">
        <form class="form-horizontal" action="" method="">
            <input type="hidden" id="ACTION" name="ACTION" value="COMPLETE" >
            <input type="hidden" id="REST" name="REST" value="" >
            <div class="contents-table">
                ###TABLE###
            </div>
        </form>
    </div>
</div>
<!--</html>-->

<script>

    //カテゴリ名新規追加
    function newOperationCategory() {
        $('#REST').val('POST'); //REST
        var new_category_name = $('#NEW_OPERATION_CATEGORY_NAME').val(); //MSG用
        var params = $('form').serialize();
        jqXHR = $.ajax({
            type: 'POST',
            url: '/APP/OPERATION_CATEGORY/NEW',
            data: params
        });
        jqXHR.done(function(data) {
            if (data == 2222) {
                alert(new_category_name + "は、既に使われています。");
            } else {
                $('table').html(data);
                $('#info-msg').html(new_category_name + "を追加しました。");
                alert(new_category_name + "を追加しました。");
            }
        });
        jqXHR.fail(function(data) {
            alert("新規登録処理に失敗しました。");
        });
    }

    //カテゴリ名変更
    function editOperationCategory(id) {
        if (id == 999) {
            alert("更新対象です。");
            return false;
        }
        var edit_category_name = $('#OPERATION_CATEGORY_NAME_' + id).val();
        var params = $('form').serialize();
        var jqXHR = $.ajax({
            type: 'POST',
            url: '/APP/OPERATION_CATEGORY/EDIT',
            data: {
                REST: 'PUT',
                ACTION: 'COMPLETE',
                OPERATION_CATEGORY_ID: id,
                OPERATION_CATEGORY_NAME: edit_category_name
            }
        });
        jqXHR.done(function(data) {
            if (data == 2222) {
                alert(edit_category_name + "は、既に使われています。");
            } else {
                alert('No:' + id + 'を'+ edit_category_name + "に変更しました。");
                $('#info-msg').html('No:' + id + 'を'+ edit_category_name + "に変更しました。");
            }
        });
        jqXHR.fail(function() {
            alert("更新処理に失敗しました。");
        });
    }

    //カテゴリ名削除
    function deleteOperationCategory(id) {
        if (id == 999) {
            alert("削除対象外です。");
            return false;
        }
        var delete_category_name = $('#OPERATION_CATEGORY_NAME_' + id).val();
        var params = $('form').serialize();
        var jqXHR = $.ajax({
            type: 'POST',
            url: '/APP/OPERATION_CATEGORY/DELETE',
            data: {
                REST: 'DELETE',
                ACTION: 'COMPLETE',
                OPERATION_CATEGORY_ID: id,
                OPERATION_CATEGORY_NAME: delete_category_name
            }
        });
        jqXHR.done(function(data) {
            if (data == 111) {
                var sel = '#edit-row-' + id;
                $(sel).remove();
                alert('No:' + id + 'の'+ delete_category_name + "を削除しました。");
                $('#info-msg').html('No:' + id + 'の' + delete_category_name + "を削除しました。");
            } else {
                alert('No:' + id + 'の' +  delete_category_name + "を削除出来ませんでした。");
                $('#info-msg').html('No:' + id + 'の' +  delete_category_name + "を削除出来ませんでした。");
            }
        });
        jqXHR.fail(function() {
            alert("削除処理に失敗しました。");
        });
 
    }

</script>
<!--</html>-->
